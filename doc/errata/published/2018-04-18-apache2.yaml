product: ucs
release: "4.2"
version: [3]
scope: ucs_4.2-0-errata4.2-3
src: apache2
fix: 2.4.10-10+deb8u12A~4.2.3.201804040747
desc: |
 This update addresses the following issues:
 * Activate mod_reqtimeout in new installs and during updates from before
   2.4.10-10+deb8u8. It was wrongly not activated in new installs since
   jessie. This made the default installation vulnerable to some DoS attacks.
 * mod_session_crypto was encrypting its data/cookie using the configured
   ciphers with possibly either CBC or ECB modes of operation (AES256-CBC by
   default), hence no selectable or builtin authenticated encryption. This
   made it vulnerable to padding oracle attacks, particularly with CBC.
   (CVE-2016-0736)
 * Malicious input to mod_auth_digest can cause the server to crash, and each
   instance continues to crash even for subsequently valid requests.
   (CVE-2016-2161)
 * Apache was liberal in the whitespace accepted from requests and sent in
   response lines and headers. Accepting these different behaviors represented
   a security concern when httpd participates in any chain of proxies or
   interacts with back-end application servers, either through mod_proxy or
   using conventional CGI mechanisms, and may result in request smuggling,
   response splitting and cache pollution. (CVE-2016-8743)
 * In Apache use of the ap_get_basic_auth_pw() by third-party modules outside
   of the authentication phase may lead to authentication requirements being
   bypassed. (CVE-2017-3167)
 * mod_ssl may dereference a NULL pointer when third-party modules call
   ap_hook_process_connection() during an HTTP request to an HTTPS port.
   (CVE-2017-3169)
 * The HTTP strict parsing changes introduced a bug in token list parsing,
   which allows ap_find_token() to search past the end of its input string. By
   maliciously crafting a sequence of request headers, an attacker may be able
   to cause a segmentation fault, or to force ap_find_token() to return an
   incorrect value. (CVE-2017-7668)
 * mod_mime can read one byte past the end of a buffer when sending a
   malicious Content-Type response header. (CVE-2017-7679)
 * The value placeholder in [Proxy-]Authorization headers of type 'Digest' was
   not initialized or reset before or between successive key=value assignments
   by mod_auth_digest. Providing an initial key with no '=' assignment could
   reflect the stale value of uninitialized pool memory used by the prior
   request, leading to leakage of potentially confidential information, and a
   segfault in other cases resulting in denial of service. (CVE-2017-9788)
 * Apache httpd allows remote attackers to read secret data from process
   memory if the Limit directive can be set in a user's .htaccess file, or if
   httpd.conf has certain misconfigurations, aka Optionsbleed. (CVE-2017-9798)
 * mod_authnz_ldap, if configured with AuthLDAPCharsetConfig, uses the
   Accept-Language header value to lookup the right charset encoding when
   verifying the user's credentials. If the header value is not present in the
   charset conversion table, a fallback mechanism is used to truncate it to a
   two characters value to allow a quick retry (for example, 'en-US' is
   truncated to 'en'). A header value of less than two characters forces an
   out of bound write of one NUL byte to a memory location that is not part of
   the string. In the worst case, quite unlikely, the process would crash
   which could be used as a Denial of Service attack. In the more likely case,
   this memory is already reserved for future use and the issue has no effect
   at all. (CVE-2017-15710)
 * The expression specified in <FilesMatch> could match '$' to a newline
   character in a malicious filename, rather than matching only the end of the
   filename. This could be exploited in environments where uploads of some
   files are are externally blocked, but only by matching the trailing portion
   of the filename. (CVE-2017-15715)
 * When mod_session is configured to forward its session data to CGI
   applications (SessionEnv on, not the default), a remote user may influence
   their content by using a "Session" header. This comes from the
   "HTTP_SESSION" variable name used by mod_session to forward its data to
   CGIs, since the prefix "HTTP_" is also used by the Apache HTTP Server to
   pass HTTP header fields, per CGI specifications. (CVE-2018-1283)
 * A specially crafted request could have crashed the Apache HTTP Server due
   to an out of bound access after a size limit is reached by reading the HTTP
   header. This vulnerability is considered very hard if not impossible to
   trigger in non-debug mode (both log and build level), so it is classified
   as low risk for common server usage. (CVE-2018-1301)
 * A specially crafted HTTP request header could have crashed the Apache HTTP
   Server due to an out of bound read while preparing data to be cached in
   shared memory. It could be used as a Denial of Service attack against users
   of mod_cache_socache. The vulnerability is considered as low risk since
   mod_cache_socache is not widely used, mod_cache_disk is not concerned by
   this vulnerability. (CVE-2018-1303)
 * When generating an HTTP Digest authentication challenge, the nonce sent to
   prevent reply attacks was not correctly generated using a pseudo-random
   seed. In a cluster of servers using a common Digest authentication
   configuration, HTTP requests could be replayed across servers by an
   attacker without detection. (CVE-2018-1312)
bug: [44400]
cve:
- CVE-2016-0736
- CVE-2016-2161
- CVE-2016-8743
- CVE-2017-3167
- CVE-2017-3169
- CVE-2017-7668
- CVE-2017-7679
- CVE-2017-9788
- CVE-2017-9798
- CVE-2017-15710
- CVE-2017-15715
- CVE-2018-1283
- CVE-2018-1301
- CVE-2018-1303
- CVE-2018-1312
erratum: 324
announced: 2018-04-18
