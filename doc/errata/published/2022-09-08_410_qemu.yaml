product: ucs
release: "5.0"
version: [2]
scope: ucs_5.0-0-errata5.0-2
src: qemu
fix: 1:3.1+dfsg-8+deb10u9
desc: |
 This update addresses the following issues:
 * `sd_wp_addr` in `hw/sd/sd.c` uses an unvalidated address, which leads to an
   out-of-bounds read during sdhci_write() operations. A guest OS user can
   crash the QEMU process. (CVE-2020-13253)
 * A MemoryRegionOps object may lack read/write callback methods, leading to a
   NULL pointer dereference. (CVE-2020-15469)
 * Use-after-free in `hw/net/e1000e_core.c` because a guest OS user can
   trigger an e1000e packet with the data's address set to the e1000e's MMIO
   address. (CVE-2020-15859)
 * The patch for CVE-2020-17380/CVE-2020-25085 was found to be ineffective,
   thus making QEMU vulnerable to the out-of-bounds read/write access issues
   previously found in the SDHCI controller emulation code. This flaw allows a
   malicious privileged guest to crash the QEMU process on the host, resulting
   in a denial of service or potential code execution. (CVE-2021-3409)
 * Use-after-free in `hw/usb/hcd-xhci.c` because the usb_packet_map return
   value is not checked. (CVE-2020-25084)
 * Heap-based Buffer Overflow in `flatview_read_continue` in `exec.c` because
   `hw/sd/sdhci.c` mishandles a write operation in the SDHC_BLKSIZE case.
   (CVE-2020-25085)
 * `hw/usb/hcd-ohci.c` has a stack-based buffer over-read via values obtained
   from the host controller driver.(CVE-2020-25624)
 * `hw/usb/hcd-ohci.c` has an infinite loop when a transfer direcriptor list
   has a loop. (CVE-2020-25625)
 * A reachable assertion issue was found in the USB EHCI emulation code. It
   could occur while processing USB requests due to missing handling of DMA
   memory map failure. A malicious privileged user within the guest may abuse
   this flaw to send bogus USB requests and crash the QEMU process on the
   host, resulting in a denial of service. (CVE-2020-25723)
 * `eth_get_gso_type` in `net/eth.c` guest OS users to trigger an assertion
   failure. A guest can crash the QEMU process via packet data that lacks a
   valid Layer 3 protocol. (CVE-2020-27617)
 * `hw/net/e1000e_core.c` has an infinite loop via an RX descriptor with a
   NULL buffer address. (CVE-2020-28916)
 * `slirp.c` in `libslirp` has a buffer over-read because it tries to read a
   certain amount of header data even if that exceeds the total packet length.
   (CVE-2020-29130)
 * `ide_atapi_cmd_reply_end` in `hw/ide/atapi.c` allows out-of-bounds read
   access because a buffer index is not validated. (CVE-2020-29443)
 * A use-after-free flaw was found in the MegaRAID emulator. This issue occurs
   while processing SCSI I/O requests in the case of an error
   `mptsas_free_request()` that does not dequeue the request object `req` from
   a pending requests queue. This flaw allows a privileged guest user to crash
   the QEMU process on the host, resulting in a denial of service.
   (CVE-2021-3392)
 * A potential stack overflow via infinite loop issue was found in various NIC
   emulators. The issue occurs in loopback mode of a NIC wherein reentrant DMA
   checks get bypassed. A guest user/process may use this flaw to consume CPU
   cycles or crash the QEMU process on the host resulting in DoS scenario.
   (CVE-2021-3416)
 * A flaw was found in the USB redirector device (usb-redir) of QEMU. Small
   USB packets are combined into a single, large transfer request, to reduce
   the overhead and improve performance. The combined size of the bulk
   transfer is used to dynamically allocate a variable length array (VLA) on
   the stack without proper validation. Since the total size is not bounded, a
   malicious guest could use this flaw to influence the array length and cause
   the QEMU process to perform an excessive allocation on the stack, resulting
   in a denial of service. (CVE-2021-3527)
 * An invalid pointer initialization issue was found in the SLiRP networking
   implementation. The flaw exists in the function `udp6_input()` and could
   occur while processing a UDP packet that is smaller than the size of the
   structure `udphdr`. This issue may lead to out-of-bounds read access or
   indirect host memory disclosure to the guest. (CVE-2021-3593)
 * An invalid pointer initialization issue was found in the SLiRP networking
   implementation. The flaw exists in the function `udp_input()` and could
   occur while processing a UDP packet that is smaller than the size of the
   structure `udphdr`. This issue may lead to out-of-bounds read access or
   indirect host memory disclosure to the guest. (CVE-2021-3594)
 * An invalid pointer initialization issue was found in the SLiRP networking
   implementation. The flaw exists in the function `tftp_input()` and could
   occur while processing a UDP packet that is smaller than the size of the
   structure `tftp_t`. This issue may lead to out-of-bounds read access or
   indirect host memory disclosure to the guest. (CVE-2021-3595)
 * A flaw was found in the USB redirector device emulation. It occurs when
   dropping packets during a bulk transfer from a SPICE client due to the
   packet queue being full. A malicious SPICE client could use this flaw to
   make QEMU call `free()` with faked heap chunk metadata, resulting in a
   crash of QEMU or potential code execution with the privileges of the QEMU
   process on the host. (CVE-2021-3682)
 * An out-of-bounds write flaw was found in the UAS (USB Attached SCSI) device
   emulation. The device uses the guest supplied stream number unchecked,
   which can lead to out-of-bounds access to the `UASDevice->data3` and
   `UASDevice->status3` fields. A malicious guest user could use this flaw to
   crash QEMU or potentially achieve code execution with the privileges of the
   QEMU process on the host. (CVE-2021-3713)
 * A use-after-free vulnerability was found in the virtio-net device of QEMU.
   It could occur when the descriptor's address belongs to the non direct
   access region, due to num_buffers being set after the virtqueue elem has
   been unmapped. A malicious guest could use this flaw to crash QEMU,
   resulting in a denial of service condition, or potentially execute code on
   the host with the privileges of the QEMU process. (CVE-2021-3748)
 * An off-by-one error was found in the SCSI device emulation. It could occur
   while processing commands `MODE SELECT` in `mode_sense_page()` if the
   `page` argument was set to `MODE_PAGE_ALLS` (0x3f). A malicious guest could
   use this flaw to potentially crash QEMU, resulting in a denial of service
   condition. (CVE-2021-3930)
 * A race condition flaw was found in the 9pfs server implementation. This
   flaw allows a malicious 9p client to cause a use-after-free error,
   potentially escalating their privileges on the system. (CVE-2021-20181)
 * A NULL pointer dereference flaw was found in the floppy disk emulator. This
   issue occurs while processing read/write ioport commands if the selected
   floppy drive is not initialized with a block device. This flaw allows a
   privileged guest user to crash the QEMU process on the host, resulting in a
   denial of service. (CVE-2021-20196)
 * An integer overflow issue was found in the vmxnet3 NIC emulator. It may
   occur if a guest was to supply invalid values for rx/tx queue size or other
   NIC parameters. A privileged guest user may use this flaw to crash the QEMU
   process on the host resulting in DoS scenario. (CVE-2021-20203)
 * An out-of-bounds heap buffer access issue was found in the ARM Generic
   Interrupt Controller emulator on aarch64 platform. The issue occurs because
   while writing an interrupt ID to the controller memory area, it is not
   masked to be 4 bits wide. It may lead to the said issue while updating
   controller state fields and their subsequent processing. A privileged guest
   user may use this flaw to crash the QEMU process on the host resulting in
   DoS scenario. (CVE-2021-20221)
 * A stack overflow via an infinite recursion vulnerability was found in the
   eepro100 i8255x device emulator. This issue occurs while processing
   controller commands due to a DMA reentry issue. This flaw allows a guest
   user or process to consume CPU cycles or crash the QEMU process on the
   host, resulting in a denial of service. (CVE-2021-20255)
 * An infinite loop flaw was found in the e1000 NIC emulator. This issue
   occurs while processing transmits (tx) descriptors in `process_tx_desc` if
   various descriptor fields are initialized with invalid values. This flaw
   allows a guest to consume CPU cycles on the host, resulting in a denial of
   service. (CVE-2021-20257)
 * A flaw was found in the vhost-vsock device of QEMU. In case of error, an
   invalid element was not detached from the virtqueue before freeing its
   memory, leading to memory leakage and other unexpected results.
   (CVE-2022-26354)
bug: [55167]
cve:
- CVE-2020-13253
- CVE-2020-27617
- CVE-2020-25723
- CVE-2020-25625
- CVE-2020-25624
- CVE-2020-25085
- CVE-2020-15469
- CVE-2020-15859
- CVE-2020-25084
- CVE-2020-28916
- CVE-2020-29130
- CVE-2020-29443
- CVE-2021-20181
- CVE-2021-20221
- CVE-2021-3392
- CVE-2021-3409
- CVE-2021-3416
- CVE-2021-20203
- CVE-2021-20255
- CVE-2021-20257
- CVE-2021-3713
- CVE-2021-3682
- CVE-2021-3527
- CVE-2021-3594
- CVE-2021-3595
- CVE-2021-3593
- CVE-2021-3748
- CVE-2021-3930
- CVE-2021-20196
- CVE-2022-26354
erratum: 410
announced: 2022-09-08
