<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
          "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [

  <!ENTITY % entities SYSTEM "../stylesheets/macros-en.ent" >
  <!ENTITY bibliography SYSTEM "../stylesheets/bibliography-en.xml">
  <!ENTITY changelog SYSTEM "changelog-3.2.xml">

  %entities;
]>
<book lang="en" id="releasenotes-3.2-en">
    <bookinfo>
      <title>UCS 3.2 Release Notes</title>
      <subtitle>Release notes for the installation and update of Univention Corporate Server (UCS) 3.2</subtitle>

        <revhistory>
            <revision>
                <revnumber>3.2-0</revnumber>
                <date>16 Jul 2013</date>
            </revision>
        </revhistory>

		<legalnotice>
		  <para>
			Alle Rechte vorbehalten. / All rights reserved.
		  </para>

		  <para>
			(c) 2002 bis 2013 Univention GmbH
		  </para>

		  <para>
			Mary-Somerville-Straße 1, 28359 Bremen, Deutschland/Germany
		  </para>

		  <para>
			feedback@univention.de
		  </para>

		  <para>
			Jede aufgeführte Marke und jedes Warenzeichen steht im Eigentum
			ihrer jeweiligen eingetragenen Rechtsinhaber. Linux ist ein
			eingetragenes Warenzeichen von Linus Torvalds.
		  </para>

		  <para>
			The mentioned brand names and registered trademarks are owned by
			the respective legal owners in each case. Linux is a registered
			trademark of Linus Torvalds.
		  </para>
		</legalnotice>

    </bookinfo>

    <chapter>
	  <title>Release highlights</title>

		<para>
		  With Univention Corporate Server 3.2, the first point release for Univention Corporate
		  Server (UCS) 3.1 is now available. It provides several improvements and bugfixes:
		</para>

		<itemizedlist>
		  <listitem>
			<para> 
			  TODO
			</para>
		  </listitem>
		</itemizedlist>
    </chapter>

    <chapter>
	  <title>Recommended update order for environments with more than one UCS server / Updating systems with UCS components</title>

		<para>
		  In environments with more than one UCS system, the update order of the UCS systems must be
		  borne in mind:
		</para>

		<para>
		  The authoritative version of the LDAP directory service is maintained on the master domain
		  controller and replicated on all the remaining LDAP servers of the UCS domain. As changes 
		  to the LDAP schemes can occur during release updates), the master domain controller must
		  always be the first system to be updated during a release update.
		</para>

		<para>
		  It is generally advisable to update all UCS systems in one maintenance window whenever
		  possible. 
		</para>

	  <section>
		<title>Information on environments with third-party software</title>
		<para>
		  When using third-party software it should generally be clarified with the
		  manufacturer/reseller <emphasis>before</emphasis> the update whether it can still be used
		  without restrictions with the latest version of Univention Corporate Server. 
		</para>

		<para>
		  The manufacturers/resellers of products based on Univention Corporate Server are
		  responsible for the publication themselves. Updates must thus be procured from them.
		</para>

		<para>
		  If you were provided with modified package versions by Univention, you must check whether
		  the update will overwrite the coordinated packages - preferably in a test environment. If
		  you identify any problems here, please contact Univention.
		</para>
	  </section>
	</chapter>

    <chapter>
	  <title>Preparation of update</title>

		<para>
		  It must be checked whether sufficient disk space is available. A standard installation
		  requires a minimum of 6 GB of memory. Depending on the scope of the existing installation,
		  the update will require at least another 1 GB of memory for the downloading and
		  installation of the packages.
		</para>

		<para>
		  For the update, a login should be performed on the console with the
		  <emphasis>root</emphasis> user and then the update started there. Alternatively, the
		  update can be initiated using the &ucsUMC;.
		</para>

		<para>
		  Remote updating via SSH is not recommended as this may result in the update procedure
		  being cancelled if the network connection is interrupted, for example, and this can affect
		  the system. If updating should occur over a network connection nevertheless, it must be
		  verified that the update continues despite disconnection from the network. This can be
		  done, for example, using the tools <command>screen</command> and <command>at</command>,
		  which are installed on all system roles.
		</para>

	  <section>
		<title>Checking the size of the BDB database of systems with Cyrus IMAP server (univention-mail-cyrus)</title>
		<para>
		  As of UCS 3.2, the univention-mail-cyrus package includes a new &ucsUCR; template for
		  the configuration file of the Cyrus BDB database (<filename>/var/lib/cyrus/db/DB_CONFIG</filename>).
		</para>

		<para>
		  The default values of the UCR variables for the configuration of the BDB database are:

		  <itemizedlist>
			<listitem><para> 
			  mail/cyrus/bdb/dbconfig/set_lg_regionmax : "2097152"
			</para></listitem>

			<listitem><para> 
			  mail/cyrus/bdb/dbconfig/set_cachesize : "0 2097152 1"
			</para></listitem>
		  </itemizedlist>
		</para>

		<para>
		  Any existing Cyrus BDB configuration will be copied to
		  <filename>/var/lib/cyrus/db/DB_CONFIG.debian</filename> during the update. If the new
		  default values do not correspond to the old, existing configuration or if the used options are
		  not available in the new default values, the corresponding &ucsUCR; variables should be
		  set prior to the update. E.g.:
		</para>

<programlisting language="sh">
ucr set mail/cyrus/bdb/dbconfig/set_cachesize="0 4097152 1"
ucr set mail/cyrus/bdb/dbconfig/set_lg_regionmax="2097152"
ucr set mail/cyrus/bdb/dbconfig/set_lg_max="1048576"
</programlisting>
	  </section>

	  <section>
		<title>Updates to the Univention Directory listener module for Cyrus users</title>
		<para>
		  The listener module for the administration of mailboxes has been revised. Mailboxes are
		  now only created if the <emphasis>mailHomeServer</emphasis> attribute is set for the user
		  (in the UMC under <guimenu>Advanced settings -> Mail home server </guimenu>).
		</para>

		<para>
		  If the <envar>mail/cyrus/mailbox/delete</envar> &ucsUCRV; has been activated on the mail
		  server and the attribute is removed from the user object, the mailbox is deleted.
		</para>

		<para>
		  Prior to the update, a check should be made for whether the mail home server is set for
		  all Cyrus users.
		</para>
	  </section>


	  <section>
	  	<title>Removed/no longer supported components</title>
	  	<para>
		  Some components have been removed and are no longer provided with UCS 3.2:

	  	  <itemizedlist>
	  		<listitem><para>
			  The UMC module <guimenu>VNC</guimenu> has been removed. Xrdp can be
			  installed via the Univention App Center as an alternative for graphic remote logins to
			  UCS servers.
			</para></listitem>

			<listitem><para>
			  The <emphasis>univention-local-users</emphasis> package (it was only part of the
			  unmaintained repository section) has been removed.
			</para></listitem>

	  	  </itemizedlist>

	  	</para>
	  </section>

	</chapter>

    <chapter>
	  <title>Postprocessing of the update</title>

		<para>
		  Following the update, new or updated join scripts need to be executed. This can be done in
		  two ways: Either using the UMC module  <guimenu>Domain join</guimenu> or by running the
		  command <command>univention-run-join-scripts</command> as the user
		  <emphasis>root</emphasis>.
		</para>

		<para>
		  Subsequently the UCS system should be restarted.
		</para>

	  <section>
		<title>Migration to GRUB 2</title>
		<para>
		  Starting with UCS 3.0, in a new installation, the Univention Installer writes GRUB 2 in
		  the boot sector directly.
		</para>

		<para>
		  In an updated system, GRUB 1 remains installed in the master boot record (MBR). Grub 2
		  sets up a "Chainload into GRUB" entry, which then loads the actual GRUB 2.
		</para>

		<para>
		  Documentation explaining how to write GRUB 2 directly in the MBR on updated systems is
		  provided in the Univention Support Database
		  (<ulink url="http://sdb.univention.de/1218"/>).
		</para>
	  </section>

	  <section>
		<title>Migration of PostgreSQL 8.3 to PostgreSQL 8.4</title>
		<para>
		  As of UCS 3.0, PostgreSQL 8.4 is also available in addition to PostgreSQL 8.3. When
		  systems with PostgreSQL 8.3 are updated to UCS 3.0, however, the installed PostgreSQL
		  version is retained.
		</para>

		<para>
		  The update to PostgreSQL 8.4 is described in the SDB article <ulink
		  url="http://sdb.univention.de/1220"/>.
		</para>
	  </section>

	  <section>
		<title>Update/installation of the Horde Groupware Webmail Edition</title>
		<para>
		  As of UCS 3.2, the Horde Groupware Webmail Edition will no longer be available via the
		  <emphasis>univention-horde4</emphasis> package and will be provided instead via the
		  Univention App Center. The update of univention-horde4 to or initial installation of Horde
		  5.1.0 is performed by installing the <emphasis>Horde Groupware Webmail Edition</emphasis>
		  app in the Univention App Center.
		</para>
	  </section>

	  <section>
	  	<title>Updating the supported protocols for Samba file services</title>
	  	<para>
		  In versions before UCS 3.2, Samba used the CIFS protocol to provide file services. In new
		  installations as of UCS 3.2, the successor SMB2 is enabled as standard. Using a client
		  which supports SMB2 (as of Windows Vista, i.e., Windows 7/8 too) improves the performance
		  and scalability.
		</para>

	  	<para>
		  In the case of updates from earlier UCS releases, Samba continues to use CIFS. To enable
		  the use of SMB2 subsequently, the &ucsUCR; variable <envar>samba/max/protocol</envar> must
		  be set to <emphasis>SMB2</emphasis> on all Samba servers and the Samba server(s)
		  restarted.
	  	</para>
	  </section>

	  <section>
		<title>Operating a local repository server / pre-up/ post-up scripts</title>
		<para>
		  Pre-up and postup scripts are scripts which are run before and after release updates
		  (e.g., for post-processing the update, for example by uninstalling obsolete packages). As
		  of UCS 3.2, these scripts are supplied via DEB packages (in earlier versions they were
		  supplied as files, but as such were not covered by Secure Apt).
		</para>

		<para>
		  If a repository server is operated with UCS 3.1-x, it should be updated to UCS 3.2
		  before additional systems can be updated to UCS 3.2-1.
		</para>

		<para>
		  If it is not possible to update the repository server, the files can also be synchronised
		  manually:

<programlisting language="sh">
LOCAL_DIR=/var/lib//univention-repository/mirror
SERVER=http://updates.software-univention.de
for release in 3.2-0 3.2-1; do
  for f in preup postup; do
    FILE=3.2/maintained/$release/all/${f}.sh.gpg
    wget $SERVER/$FILE -O $LOCAL_DIR/$FILE
  done
done
</programlisting>
		</para>

		<para>
		  Alternatively, it is also possible to disable the signature checks. This is done by
		  setting the &ucsUCR; variable <envar>repository/online/verify</envar> to
		  <emphasis>false</emphasis>.
		</para>
	  </section>
	</chapter>

    <chapter>
	  <title>Further notes on selected packages</title>

	  <section>
		<title>Collection of usage statistics when using the free-for-personal-use version</title>
		<para>
		  Anonymous usage statistics on the use of the &ucsUMC; are collected when using the
		  <emphasis>free for personal use</emphasis> version of UCS (which is generally used for
		  evaluating UCS). The modules opened are logged in an instance of the web traffic analysis
		  tool Piwik. This makes it possible for Univention to tailor the development of the
		  &ucsUMC; better to customer needs and carry out usability improvements.
		</para>

		<para>
		  This logging is only performed when the free-for-personal-use license is used. The license
		  status can be verified by clicking on the cog symbol in the top righthand corner of the
		  &ucsUMC; and selecting <guimenu>License</guimenu>. If <emphasis>Free for personal use
		  edition</emphasis> is listed under <guimenu>LDAP base</guimenu>, this version is in
		  use. When a regular UCS license is used, no usage statistics are collected.
		</para>

		<para>
		  Indendepent of the licence used, the statistics generation can be deactivated by setting
		  the &ucsUCR; variable <envar>umc/web/piwik</envar> to <emphasis>false</emphasis>.
		</para>
	  </section>

	  <section>
		<title>Boot problems when using the UEFI installation DVD</title>
		<para>
		  Starting with UCS 3.1, in addition to the standard installation DVD there is also a medium
		  with support for the Unified Extensible Firmware Interface standard (UEFI) available for
		  the amd64 architecture.
		</para>

		<para>
		  It can be used instead of the standard DVD on systems which only support a UEFI boot.
		</para>
	  </section>

	  <section>
		<title>Scope of security support for Webkit, Konqueror und QtWebKit</title>
		<para>
		  Webkit, Konqueror and QtWebkit are shipped in the maintained branch of the UCS repository,
		  but not covered with security support. Webkit is primarily used for displaying HTML help
		  pages etc. Firefox should be used as the web browser.
		</para>
	  </section>

	  <section>
		<title>Recommeded browsers for the access to the Univention Management Console</title>

		<para>
		  &ucsUMC; uses numerous Javascript and CSS functions to display the web interface. Cookies
		  need to be permitted in the browser. The following browsers are recommended:
		</para>

		  <itemizedlist>
			<listitem>
			  <para>Chrome as of version 14</para>
			</listitem>

			<listitem>
			  <para>Firefox as of version 10</para>
			</listitem>

			<listitem>
			  <para>Internet Explorer as of version 9</para>
			</listitem>

			<listitem>
			  <para>Safari (on the iPad 2)</para>
			</listitem>
		  </itemizedlist>

		<para>
		  Users with older browsers may experience display or performance problems. 
		</para>
	  </section>

	  <section>
		<title>Restrictions in Samba 4 operation</title>
		<para>
		  The versions of Samba 4 currently published by the Samba project are undergoing more
		  intensive changes in their further development than Samba 3. For this reason, some
		  functions are not yet completely available:
		</para>

		  <itemizedlist>
			<listitem>
			  <para> 
				Microsoft Windows domain controllers cannot be joined in a Samba 4 domain
				currently. 
			  </para>
			</listitem>

			<listitem>
			  <para>
				Selective replication is not possible with Samba 4 as this is not supported by
				Active Directory in principle (in UCS@school selective replication is implemented
				through the listener/notifier replication mechanism).
			  </para>
			</listitem>

			<listitem>
			  <para>
				Samba 4 does not currently support forest domains. 
			  </para>
			</listitem>

			<listitem>
			  <para> 
				Samba 4 does not currently support trust relationships.
			  </para>
			</listitem>
		  </itemizedlist>

		<para>
		  Further information can be found in Chapter 8 of the UCS manual <citation>UCS-Handbuch</citation>.
		</para>
	  </section>

	  <section>
		<title>Installation in VirtualBox</title>
		<para>
		  During the installation of UCS in the virtualization solution VirtualBox, a bug may appear
		  which has been corrected in version 4.2: if UCS has been successfully installed and the
		  DVD is still in the disk drive, the installation DVD offers the option <guimenu>Boot from
		  first harddisk partition</guimenu>. If you select this option, VirtualBox freezes. 
		</para>

		<para>
		  For Linux distributions which still use Virtualbox 4.0 or 4.1, either the installation DVD
		  can be taken out of the drive settings of the VirtualBox VM or F12 pressed when starting
		  the virtual instance and the hard drive selected as a boot partition as a workaround
		  before starting the UCS VM. UCS will then start successfully.
		</para>
	  </section>

	  <section>
		<title>Migration of a Samba 3 environment to Samba 4</title>
		<para>
		  There are two basic procedures for migrating Samba 3 to Samba 4:
		</para>

		<itemizedlist>
		<listitem>
		  <para> 
			Setup of a parallel Samba 4 domain. Both domains use different NetBIOS names and
			SIDs. The clients then join the Samba 4 step by step.
		  </para>
		</listitem>

		<listitem>
		  <para> 
			Migration of all systems within one maintenance window.
		  </para>
		</listitem>
		</itemizedlist>

		<para>
		  Both procedures are documented in detail in the Univention Wiki:
		  <ulink url="http://wiki.univention.de/index.php?title=Migration_from_Samba_3_to_Samba_4"/>.
		</para>
	  </section>

	  <section>
		<title>Xen</title>
		<para> 
		  If the Xen hypervisor is used and the memory limit for the Dom0 has been configured using
		  the &ucsUCR;-Variable <envar>grub/xenhopt</envar>, the value should be updated to include
		  the <emphasis>,max:</emphasis> part as well. See the
		  <ulink url="http://wiki.univention.de/index.php?title=UVMM_Quickstart-3.1/en#Configuring_the_Dom0"/>
		  for details.
		</para>
	  </section>
	</chapter>

    <chapter>
	  <title>Changelog</title>
	  <para>
		Listed are the changes since UCS 3.1-1:
	  </para>

	  &changelog;

	</chapter>

    <?dbhtml-include href="../stylesheets/piwiki.html"?>
</book>
